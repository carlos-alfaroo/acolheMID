{% extends "base-inventory.html" %}
{% block title %}Editar Producto{% endblock %}

{% block content %}

  <div class="min-h-screen bg-gray-100 flex flex-col">
    <header class="flex items-center justify-between py-6 px-4 border-b border-gray-200 bg-white">
      <h2 class="text-2xl font-semibold text-gray-900">Editar Producto</h2>
      <a href="{{ url_for('inventory.products_inventory') }}" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
        Volver a la lista
      </a>
    </header>

      <main class="flex-grow p-6">
        <form method="POST" enctype="multipart/form-data" action="{{ url_for('inventory.edit_product', id=product.id) }}" class="max-w-3xl mx-auto space-y-6 bg-white p-6 rounded-md shadow">
        {{ form.hidden_tag() }}

      <!-- Nombre -->
      <div>
        {{ form.name.label(class="block text-sm font-medium text-gray-700") }}
        {{ form.name(class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm") }}
        {% for error in form.name.errors %}
          <p class="mt-1 text-sm text-red-600">{{ error }}</p>
        {% endfor %}
      </div>
        
      <!-- Descripción -->
      <div>
        {{ form.description.label(class="block text-sm font-medium text-gray-700") }}
        {{ form.description(class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm") }}
        {% for error in form.description.errors %}
          <p class="mt-1 text-sm text-red-600">{{ error }}</p>
        {% endfor %}
      </div>

      <!-- Precio -->
      <div>
        {{ form.price.label(class="block text-sm font-medium text-gray-700") }}
        {{ form.price(class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm") }}
        {% for error in form.price.errors %}
          <p class="mt-1 text-sm text-red-600">{{ error }}</p>
        {% endfor %}
      </div>

      <!-- Stock -->
      <div>
        {{ form.stock.label(class="block text-sm font-medium text-gray-700") }}
        {{ form.stock(class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm") }}
        {% for error in form.stock.errors %}
          <p class="mt-1 text-sm text-red-600">{{ error }}</p>
        {% endfor %}
      </div>

      <!-- Categoría -->
      <div>
        {{ form.category.label(class="block text-sm font-medium text-gray-700") }}
        {{ form.category(class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-sm") }}
        {% for error in form.category.errors %}
          <p class="mt-1 text-sm text-red-600">{{ error }}</p>
        {% endfor %}
      </div>

        <!-- Imagen actual -->
        <div>
          <label class="block text-sm font-medium text-gray-700">Imagen actual</label>
          {% if product.image %}
            <img src="{{ url_for('static', filename='uploads/' ~ product.image) }}" 
                 alt="{{ product.name }}" class="w-32 h-32 object-cover rounded mt-2 mb-4 border border-gray-200">
          {% else %}
            <p class="mt-2 text-gray-500">Sin imagen</p>
          {% endif %}
        </div>

        <!-- Subir nueva imagen -->
        <div>
          {{ form.image.label(class="block text-sm font-medium text-gray-700") }}
          {{ form.image(class="mt-1 block w-full text-sm text-gray-600 border border-gray-300 rounded-md cursor-pointer bg-white file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-green-600 file:text-white hover:file:bg-green-700", required=False) }}
          <p class="mt-1 text-xs text-gray-500">Si no seleccionas nada, se mantendrá la imagen actual.</p>
          {% for error in form.image.errors %}
            <p class="mt-1 text-sm text-red-600">{{ error }}</p>
          {% endfor %}
        </div>

        <!-- Botón -->
        <div class="flex justify-end">
          <button type="submit" 
                  class="inline-flex justify-center py-2 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
            Actualizar Producto
          </button>
        </div>
      </form>
    </main>
  </div>
{% endblock %}